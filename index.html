<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no">
    <title>Playzone מכונת מזל</title>
    <!-- Google Fonts - Assistant for Hebrew -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Assistant:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">

    <!-- Firebase SDKs -->
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/9.22.0/firebase-database-compat.js"></script>

    <!-- QR Code Library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/qrcodejs/1.0.0/qrcode.min.js"></script>
</head>
<body>
    <!-- QR Code Container (Top Left) -->
    <div id="qr-container">
        <!-- QR Code Display -->
        <div id="qr-display">
            <!-- QR code and text will be generated here by JavaScript -->
        </div>

        <!-- Player Info (shown when player is active) -->
        <div id="player-info" style="display: none;">
            <div class="player-name-container">
                <span class="player-label">שחקנים פעילים:</span>
                <span class="player-name" id="player-name"></span>
            </div>
            <div class="timer-container">
                <div class="timer-display" id="player-timer">30</div>
                <div class="timer-progress-bar">
                    <div class="timer-progress" id="timer-progress"></div>
                </div>
            </div>
            <div class="player-attempts" id="player-attempts"></div>
        </div>

        <!-- Waiting Queue -->
        <div id="waiting-queue"></div>
    </div>

    <div id="slot-machine">
        <div class="reel-container">
            <div class="reel" id="reel1">
                <div class="symbol">🍒</div>
                <div class="symbol">🍋</div>
                <div class="symbol">🍊</div>
                <div class="symbol">🍉</div>
                <div class="symbol">🍇</div>
                <div class="symbol">⭐</div>
                <div class="symbol">💎</div>
                <div class="symbol">7️⃣</div>
            </div>
        </div>
        
        <div class="reel-container">
            <div class="reel" id="reel2">
                <div class="symbol">🍒</div>
                <div class="symbol">🍋</div>
                <div class="symbol">🍊</div>
                <div class="symbol">🍉</div>
                <div class="symbol">🍇</div>
                <div class="symbol">⭐</div>
                <div class="symbol">💎</div>
                <div class="symbol">7️⃣</div>
            </div>
        </div>
        
        <div class="reel-container">
            <div class="reel" id="reel3">
                <div class="symbol">🍒</div>
                <div class="symbol">🍋</div>
                <div class="symbol">🍊</div>
                <div class="symbol">🍉</div>
                <div class="symbol">🍇</div>
                <div class="symbol">⭐</div>
                <div class="symbol">💎</div>
                <div class="symbol">7️⃣</div>
            </div>
        </div>
    </div>

    <div id="win-overlay" class="hidden"></div>

    <!-- Scrolling Text Banner -->
    <div id="scrolling-banner" class="scrolling-banner hidden">
        <div class="scrolling-text" id="scrolling-text"></div>
    </div>

    <div id="qr-popup" class="hidden">
        <div class="qr-content">
            <h2>🎉 מזל טוב! זכית! 🎉</h2>

            <!-- QR Code and Steps side by side -->
            <div class="qr-main-layout">
                <!-- Right side: QR Code -->
                <div class="qr-code-section">
                    <div id="qr-code-container"></div>
                </div>

                <!-- Left side: Steps -->
                <div class="qr-steps-section">
                    <p class="qr-main-title">השלבים הבאים:</p>
                    <div class="qr-steps-vertical">
                        <div class="qr-step-item">
                            <div class="step-number">1</div>
                            <p>סרקו את הקוד לשליחת מסך הזכייה בוואטסאפ</p>
                        </div>
                        <div class="qr-step-item">
                            <div class="step-number">2</div>
                            <p>לחצו כאן על המסך או על הבאזר לחזרה אל מסך הזכייה</p>
                        </div>
                        <div class="qr-step-item">
                            <div class="step-number">3</div>
                            <p>צלמו סלפי שלכם עם מסך הזכייה</p>
                        </div>
                        <div class="qr-step-item">
                            <div class="step-number">4</div>
                            <p>שלחו לנו את התמונה</p>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Custom message at the bottom -->
            <div class="qr-custom-message" id="qr-custom-message">
                <p>👈 לחצו כדי לחזור למסך הזכייה ולצלם 📸 אחרי שסרקתם את הקוד למעלה</p>
            </div>

            <!-- Powered by Playzone -->
            <div class="qr-powered-by">
                <span>Powered by</span>
                <a href="https://playzone.co.il" target="_blank" rel="noopener">Playzone</a>
            </div>
        </div>
    </div>

    <div id="settings-screen" class="hidden">
        <button id="close-settings-x" class="close-settings-x">✕</button>
        <div class="settings-content">
            <h2>הגדרות</h2>
            
            <!-- שורה 1: סוג משחק + צבע רקע + שליטה מרחוק -->
            <div class="settings-row">
                <div class="setting-group third">
                    <h3>סוג המשחק</h3>
                    <label>
                        <input type="radio" name="game-mode" value="automatic" checked>
                        <span>רגיל (אוטומטי)</span>
                    </label>
                    <label>
                        <input type="radio" name="game-mode" value="manual">
                        <span>ידני</span>
                    </label>
                </div>

                <div class="setting-group third">
                    <h3>צבע רקע</h3>
                    <div class="color-picker-container">
                        <input type="color" id="background-color-picker" value="#1a1a2e" hidden>
                        <label for="background-color-picker" class="color-picker-label">
                            <div class="color-preview" id="color-preview"></div>
                            <span>בחר צבע</span>
                        </label>
                        <input type="text" id="background-color-input" placeholder="#1a1a2e" maxlength="7">
                        <button id="reset-background-color" class="small-btn">איפוס</button>
                    </div>
                </div>

                <div class="setting-group third">
                    <h3>🎮 שליטה מרחוק</h3>
                    <p class="setting-description">נסיונות לשחקן:</p>
                    <div class="slider-container">
                        <input type="range" id="max-player-attempts" min="0" max="10" value="3" step="1">
                        <span id="max-attempts-value">3</span>
                    </div>
                    <p class="setting-note">0 = כבוי | 1-10 = מופעל</p>
                </div>
            </div>

            <div class="settings-divider"></div>

            <!-- שורה 2: צלילים -->
            <div class="setting-group">
                <h3>צלילים</h3>

                <label class="checkbox-label">
                    <input type="checkbox" id="sound-enabled" checked>
                    <span>הפעל צלילים</span>
                </label>

                <div class="sound-uploads-grid">
                    <div class="sound-upload-item">
                        <label class="sound-label">צליל סיבוב</label>
                        <div class="sound-input-row">
                            <input type="file" id="sound-spin" accept="audio/*">
                            <button class="reset-sound" data-sound="spin">🔄</button>
                        </div>
                    </div>

                    <div class="sound-upload-item">
                        <label class="sound-label">צליל זכייה</label>
                        <div class="sound-input-row">
                            <input type="file" id="sound-win" accept="audio/*">
                            <button class="reset-sound" data-sound="win">🔄</button>
                        </div>
                    </div>

                    <div class="sound-upload-item">
                        <label class="sound-label">צליל הפסד</label>
                        <div class="sound-input-row">
                            <input type="file" id="sound-lose" accept="audio/*">
                            <button class="reset-sound" data-sound="lose">🔄</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="settings-divider"></div>

            <!-- שורה 3: תדירות זכיות + מצב זכייה מובטחת -->
            <div class="settings-row">
                <div class="setting-group half">
                    <h3>תדירות זכיות</h3>
                    <p class="setting-description">כל כמה סיבובים (0 = רנדומלי)</p>
                    <div class="slider-container">
                        <input type="range" id="win-frequency" min="0" max="20" value="3" step="1">
                        <span id="win-frequency-value">3</span>
                    </div>
                    <p class="setting-note">זכייה כל <span id="win-frequency-text">3</span> נסיונות</p>
                </div>

                <div class="setting-group half">
                    <h3>מצב זכייה מובטחת</h3>
                    <label class="checkbox-label">
                        <input type="checkbox" id="guaranteed-win-mode">
                        <span>הפעל זכייה בכל סיבוב</span>
                    </label>
                    <p class="setting-description">זכייה תמיד, הפרס לפי המלאי</p>
                </div>
            </div>

            <div class="settings-divider"></div>

            <!-- שורה: WhatsApp + טקסט QR -->
            <div class="settings-row">
                <div class="setting-group third">
                    <h3>הודעת WhatsApp בזכייה</h3>
                    <p class="setting-description">הזן מספר (עם קידומת: 972501234567)</p>
                    <div class="whatsapp-input-container">
                        <input type="text" id="whatsapp-number" placeholder="972501234567" maxlength="20">
                        <button id="clear-whatsapp" class="small-btn">נקה</button>
                    </div>
                </div>

                <div class="setting-group two-thirds">
                    <h3>טקסט מותאם במסך QR</h3>
                    <p class="setting-description">טקסט מתחת לשלבים במסך זכייה</p>
                    <div class="custom-text-container">
                        <textarea id="qr-custom-text" placeholder="אל תשכחו! כדי לקבל את הפרס אתם צריכים לשלוח לנו תמונה שלכם עם מסך הזכייה בוואטסאפ 📸" rows="3" maxlength="200"></textarea>
                        <button id="clear-custom-text" class="small-btn">נקה</button>
                    </div>
                </div>
            </div>

            <div class="setting-group">
                <h3>טקסט נגלל במסך הראשי</h3>
                <p class="setting-description">טקסט שיופיע בפס שחור מתגלגל למטה (השאר ריק כדי להסתיר)</p>
                <div class="custom-text-container">
                    <textarea id="scrolling-banner-text" placeholder="🎰 ברוכים הבאים למכונת המזל! בהצלחה! 🎰" rows="3" maxlength="300"></textarea>
                    <button id="clear-scrolling-text" class="small-btn">נקה</button>
                </div>
                <div class="font-size-control">
                    <label for="banner-font-size">גודל גופן:</label>
                    <div class="slider-container">
                        <input type="range" id="banner-font-size" min="16" max="64" value="32" step="2">
                        <span id="banner-font-size-value">32</span>
                        <span style="font-size: 0.9em; color: #ccc;">px</span>
                    </div>
                </div>
            </div>

            <div class="settings-divider"></div>

            <div class="setting-group">
                <h3>תמונות מותאמות אישית ומלאי פרסים</h3>
                <p class="setting-description">העלה מינימום 2 תמונות: לוגו + פרס אחד לפחות. מלאי ריק = בלתי מוגבל ♾️</p>
                <div id="dynamic-images-container" class="image-upload-grid">
                    <!-- תמונות יווצרו באופן דינמי דרך JavaScript -->
                </div>
                <div class="images-actions">
                    <button id="add-image-btn" class="add-image-btn">➕ הוסף תמונה נוספת</button>
                    <button id="reset-images" class="reset-images-btn">🔄 איפוס לאימוג'י ברירת מחדל</button>
                </div>
            </div>

            <div class="settings-sticky-footer">
                <button id="save-settings" class="save-btn-single">שמור</button>

                <!-- Powered by Playzone -->
                <div class="footer-powered-by">
                    <span>Powered by</span>
                    <a href="https://playzone.co.il" target="_blank" rel="noopener">Playzone</a>
                </div>
            </div>
        </div>
    </div>

    <!-- Tutorial Modal -->
    <div id="tutorial-modal" class="tutorial-overlay">
        <div class="tutorial-content">
            <h2>🎰 ברוכים הבאים למכונת המזל 777!</h2>
            <div class="tutorial-section">
                <h3>איך לשחק?</h3>
                <ul>
                    <li>🖱️ <strong>געו במסך עם היד או עם העכבר</strong> לסובב את הגלגל</li>
                    <li>🎰 <strong>לחצו על הבאזר</strong> לסובב את הגלגל</li>
                 </ul>
            </div>
            <div class="tutorial-section">
                <h3>הגדרות</h3>
                <ul>
                    <li>⚙️ <strong>להגדרות לחצו על האות S במקלדת</strong> או על כפתור ההגדרות שבצד הבאזר</li>
                    <li>🎯 <strong>תדירות זכיות</strong> - קבעו כל כמה סיבובים תזכו</li>
                    <li>🖼️ <strong>תמונות מותאמות</strong> - העלו תמונות משלכם</li>
                    <li>🎮 <strong>מצב משחק</strong> - אוטומטי או ידני</li>
                    <li>🔊 <strong>צלילים</strong> - הפעילו או כבו צלילים</li>
                </ul>
            </div>

            <div class="tutorial-buttons">
                <button id="tutorial-close">בואו נתחיל!</button>
                <button id="tutorial-settings">הגדרות</button>
            </div>

            <!-- Powered by Playzone -->
            <div class="tutorial-powered-by">
                <span>Powered by</span>
                <a href="https://playzone.co.il" target="_blank" rel="noopener">Playzone</a>
            </div>
        </div>
    </div>

    <script src="dynamic-images.js"></script>
    <script src="firebase-config.js"></script>
    <script src="session-manager.js"></script>
    <script src="remote-control-settings.js"></script>
    <script src="script.js"></script>
</body>
</html>

